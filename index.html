<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet Konum ve Yön Bilgisi</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-locatecontrol/0.76.0/L.Control.Locate.min.css" />
    <style>
        #map { height: 400px; }
    </style>
</head>
<body>
    <h2>Konum ve Yön Bilgisi</h2>
    <div id="map"></div>
    <p id="info">Konum ve yön bilgisi alınıyor...</p>
    
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-locatecontrol/0.76.0/L.Control.Locate.min.js"></script>
    <script>
        var map = L.map('map').setView([0, 0], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap Katkıda Bulunanlar'
        }).addTo(map);
        
        var direction = 0; // Başlangıç yönü
        
        function updatePosition(lat, lon, heading) {
            map.setView([lat, lon]);
            document.getElementById("info").innerText = `Konum: ${lat.toFixed(5)}, ${lon.toFixed(5)} | Yön: ${heading.toFixed(2)}°`;
        }
        
        L.control.locate({
            setView: 'always',
            drawCircle: true,
            drawMarker: false,  // Marker'ı çizme
            keepCurrentZoomLevel: true,
            showCompass: true,
            compassHeading: true,
            strings: {
                title: "Mevcut Konumu Bul"
            }
        }).addTo(map);
        
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(position => {
                var lat = position.coords.latitude;
                var lon = position.coords.longitude;
                updatePosition(lat, lon, direction);
            });
        }
        
        if (window.DeviceOrientationEvent) {
            window.addEventListener("deviceorientationabsolute", event => {
                if (event.alpha !== null) {
                    direction = event.alpha;
                }
            }, true);
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-rotatedmarker/0.2.0/leaflet.rotatedMarker.js"></script>
</body>
</html>
